<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>


    <form th:action="@{/product/newProd}" method="post" id="searchForm">
        <input name="products">
        <select name="product" class="custom-select">
            <option value="1">CAJA DE MOTA</option>
            <option value="2">VERGA</option>
            <option value="3">SEXO DURO</option>
        </select>
        <button type="button" onclick="addProduct()">Agregar</button>
        <button type="button" onclick="deleteValue(2)">Eliminar</button>
        <button type="button" onclick="addValue(2)">+++</button>
        <button type="submit">Submit</button>
    </form>
    <script>
        const addProduct = () => {
            let current = document.getElementById('searchForm').product.value;
            let products = document.getElementById('searchForm').products.value;
            if(products === '') products = [];
            else products = JSON.parse(products);

            if(products.find((product) => product.product.id == current)) return;

            products.push({
                product: {
                    id: current
                },
                quantity: 1
            });
            document.getElementById('searchForm').products.value = JSON.stringify(products);
        }
        const deleteValue = (id)=>{
            let products = document.getElementById('searchForm').products.value;
            products = JSON.parse(products);
            let product = products.find((product) => product.product.id == id) || null
            if(product){
                if (product.quantity > 1) product.quantity--;
                else products.splice(products.indexOf(product), 1);
            }
            document.getElementById('searchForm').products.value = JSON.stringify(products);
        }
        const addValue = (id)=>{
            let products = document.getElementById('searchForm').products.value;
            products = JSON.parse(products);
            products.find((product) => product.product.id == id).quantity++;
            console.log(products)
            document.getElementById('searchForm').products.value = JSON.stringify(products);
        }
    </script>
</body>
</html>